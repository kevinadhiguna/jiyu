
## Enumeration

### enum4linux

Example target: `192.168.1.10`

```sh
enum4linux -a 192.168.1.10
```

| Option | Description                                         |
| ------ | --------------------------------------------------- |
| `-a`   | Do **all** available checks (recommended for recon) |
| `-U`   | Enumerate **users**                                 |
| `-S`   | Enumerate **shares**                                |
| `-G`   | Enumerate **groups**                                |
| `-P`   | Enumerate **password policy**                       |
| `-r`   | Enumerate **RID cycling** for users/groups          |
| `-o`   | Enumerate **OS information**                        |
| `-h`   | Show **help**                                       |


#### Nmap

Example target: `192.168.1.10`

```sh
nmap -sV -sC -sT -p- 192.168.1.10
```

| Option            | Description                                        |
| ----------------- | -------------------------------------------------- |
| `-sS`             | **SYN scan** (stealthy and fast)                   |
| `-sT`             | **TCP connect** scan (less stealthy)               |
| `-sU`             | **UDP scan**                                       |
| `-sV`             | **Service version detection**                      |
| `-sC`             | Run Nmap scripts (particularly to reveal types of the software, like Vsftpd which is a type of FTP)                      |
| `-O`              | **OS detection**                                   |
| `-A`              | Aggressive scan: OS, services, traceroute, scripts |
| `-p`              | Specify port(s) (e.g., `-p 22`, `-p 1-1000`)       |
| `-p-`             | Scan all ports                                     |
| `-Pn`             | Skip host discovery (use if ICMP is blocked)       |
| `-T4`             | Set timing template for faster scanning            |
| `-oN` / `-oX`     | Output results to file (normal/XML)                |
| `--script=<name>` | Run specific NSE script(s)                         |

Note: `-sT` is similar with SYN scans but sends more packets. It is loud in network and easily detectable. However, this is used by default even if you don't specify it.


##### Fast and Verbose scan

```sh
nmap 192.168.1.10
```

##### Scan a particular port

```sh
nmap -p 80 192.168.1.10
```

##### Scan all ports

```sh
nmap -p- 192.168.1.10
```

##### Skip ping

Note: important, especially if a "normal" scan (without params) says "Host seems down"

```sh
nmap -Pn 192.168.1.10
```

##### UDP Scan

Note: Nmap does TCP scan by default

```sh
nmap -sU 192.168.1.10
```

##### Service and OS Detection Scan

```sh
### Service scan
nmap -sV 192.168.1.10
```

```sh
### Service and OS detection scan
nmap -sV -O 192.168.1.10
```

##### Default Scripts Scan

```sh
nmap -sC 192.168.1.10
```

##### Output to a file

Save the terminal output

```sh
nmap 192.168.1.10 -oN nmap_scan
```

Save the output into an XML format (can be imported to Metasploit)

```sh
nmap -oX nmap_scan 192.168.1.10
```

Save thr output into: Normal (.nmap), XML (.xml), and Grepable (.gnmap) formats

```sh
nmap -oA nmap_scan 192.168.1.10
```

##### Aggressive scan

Note: `-A` = `-sV` + `-O` + `-sC`

```sh
nmap -A 192.168.1.10
```

##### 'Skip ping' scan

Background: there are some cases in which if you perform 
```sh
nmap 192.168.1.10
```
Nmap will reply with 'Host seems down' and not even continue to port scanning. This is because Nmap carries out host discovery, then do port scanning.

In order to avoid such cases, you can do a "don't ping" scan:

```sh
nmap -Pn 192.168.1.10 
```


##### TCP-SYN ping scans: One of the most accurate way to tell if a host is up (host discovery)

Port 3389 as an example:

```sh
nmap -sn -PS3389 192.168.1.10
```

Several ports as an example:

```sh
nmap -sn -PS80,3389,445 192.168.1.10
```

A range of ports as an example:

```sh
nmap -sn -PS1-1000 192.168.1.10
```

Important note: When doing host discovery, `nmap -PS80,3390,445 192.168.1.10` takes longer than `nmap -sn -PS80,3389,445` because `-sn` skips port scanning and does ping scans.


##### TCP-ACK pings: not recommended for host discovery

Note: Not recommended for host discovery because certain systems might be configured to block packets with ACK flags set. (But might be useful for firewall discovery?)

Sending packets without SYN:

```sh
nmap -sn -PA 192.168.1.10
```


### SSH

```sh
ssh root@192.168.10
```

If there's a private key:
```sh
ssh -i id_rsa root@192.168.1.10
```


### FTP

```sh
ftp 192.168.1.10
```


### SMBclient

```sh
smbclient -L //192.168.1.10 -N
```

| Option       | Description                 |
| ------------ | --------------------------- |
| `-L //<IP>`  | List available shares       |
| `-U <user>`  | Username                    |
| `-N`         | No password (guest access)  |
| `//<IP>/share` | Connect to a specific share |


### LinEnum

```sh
./LinEnum.sh -s -k keyword -r report -e /tmp/ -t
```

| **Option** | **Description**                                                                  | **Example Command**                   |
| ---------- | -------------------------------------------------------------------------------- | ------------------------------------- |
| `-k`   | Enter **keyword** to search for during enumeration (e.g., "sudo", "password").   | `./LinEnum.sh -k "sudo"`              |
| `-e`   | Enter **export location** to save the output report.                             | `./LinEnum.sh -e /path/to/output/dir` |
| `-t`   | Include **thorough (lengthy) tests** to provide more detailed results.           | `./LinEnum.sh -t`                     |
| `-s`   | Supply **current user password** to check sudo permissions (INSECURE).           | `./LinEnum.sh -s password123`         |
| `-r`   | Enter **report name** to save the output as a specific file name (e.g., `.txt`). | `./LinEnum.sh -r linenum_report`      |
| `-h`   | Display this help text with all available options.                           | `./LinEnum.sh -h`                     |


### LDAPsearch

```sh
ldapsearch -x -h <IP> -s base
```

| Option | Description                            |
| ------ | -------------------------------------- |
| `-x`   | Simple authentication                  |
| `-h`   | LDAP server IP                         |
| `-b`   | Base DN (e.g., `dc=example,dc=com`)    |
| `-s`   | Search scope (`base`, `one`, or `sub`) |


### RPCclient

```sh
rpcclient -U "" <target>
```

| Option  | Description                   |
| ------- | ----------------------------- |
| `-U ""` | Anonymous login               |
| `-c`    | Run commands inside the shell |

Useful commands:

```sh
rpcclient $> enumdomusers
```

```sh
rpcclient $> queryuser <RID>
```

```sh
rpcclient $> netshareenum
```


### NMB Lookup

```sh
nmblookup -A 192.168.1.10
```

| Option  | Description                   |
| ------- | ----------------------------- |
| `-A <IP Address>` | lookup by IP to connect to a serverâ€™s NetBIOS info and list server connection information              |


### Hydra

```sh
hydra <flags> <IP_Address> <protocol>
```

| Option  | Description                   |
| ------- | ----------------------------- |
| `-l <username>` | login name |
| `-P <path/to/file>` | path to password wordlist |
| `-L <path/to/file>` | login username wordlist |

This will try to login to the SMB server at the IP address with the username admin trying passwords found in the rockyou txt file:
```sh
hydra -l admin -P /usr/share/wordlists/rockyou.txt 192.168.1.10 smb
```


### Directory Buster

Enumerate directories of a website from a wordlist

#### dirb

```sh
dirb example.com ~/SecList/wordlists/Discovery/Web-Content/common.txt
```

#### gobuster

```sh
gobuster dir -u example.com -w ~/SecList/wordlists/Discovery/Web-Content/common.txt
```


### Networking

#### Linux

```sh
ip route
```

#### Windows

```sh
route print
```

#### Mac OS X/Linux

```sh
netstat -r
```

### Information Gathering (Passive)

Help enumerate website information

```sh
whatweb 192.168.1.10
```

```sh
host example.com
```

#### DNS

```sh
whois example.com
whois 192.168.1.10
```

Note: Be careful using dnsenum. It carries out bruteforce by default.

```sh
dnsenum example.com
```


## Resources

- [Web Application Attacks](https://www.netsecfocus.com/oscp/2021/05/06/The_Journey_to_Try_Harder-_TJnull-s_Preparation_Guide_for_PEN-200_PWK_OSCP_2.0.html#section-9-web-application-attacks)
- [Hacking the OSCP: Web Apps](https://securing.dev/posts/hacking-the-oscp-web-apps/)
- [GTFO Bins - Unix binaries to bypass local security restrictions](https://gtfobins.github.io/)
- [Shellter](https://www.shellterproject.com/homepage/)
- [INE Training Notes - syselement](https://blog.syselement.com/ine/courses/ejpt/ejpt-cheatsheet)
